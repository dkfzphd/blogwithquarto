---
title: "How to Create Authentic Economist Style Charts in R (Advanced)"
author: "Te Guo"
date: "2026-02-08"
categories: [Data Visualization, R, ggplot2, Advanced]
image: "economist_preview.png"
description: "A deep dive into recreating The Economist's exact visual style, including the signature red header tag and custom grid styling, without relying on pre-built themes."
execute:
  warning: false
  message: false
---

In a previous attempt, we used `ggthemes`, which is great for a quick start. But to *truly* replicate *The Economist*, we need the signature **red rectangle (tag)** in the top-left corner and precise control over the grid and typography.

Here is how to do it "the hard way" — manually building the theme and using the `grid` package to draw the red tag.

## 1. Setup: Libraries and Custom Theme (设置：加载包和自定义主题)

We will define a function `add_economist_tag()` that draws the red rectangle object.

```r
# 加载必要的包
# Load necessary packages
library(ggplot2)
library(dplyr)
library(grid)
library(gridExtra)

# 定义 Economist 风格颜色
# Define Economist colors
econ_bg   <- "#d5e4eb"   # 背景蓝灰色 (Blue-gray background)
econ_grid <- "#ffffff"   # 白色网格 (White grid)
econ_red  <- "#ed1b24"   # 标志性红色 (Iconic Red)
econ_blue <- "#014d64"   # 深蓝色线条 (Dark blue lines)

# 自定义主题函数
# Custom Theme Function
theme_economist_manual <- function() {
  theme_minimal(base_size = 14) +
    theme(
      # 背景颜色 (Background color)
      plot.background  = element_rect(fill = econ_bg, color = NA),
      panel.background = element_rect(fill = econ_bg, color = NA),
      
      # 网格线：只保留水平白线 (Grid lines: horizontal white only)
      panel.grid.major.y = element_line(color = econ_grid, size = 1.2),
      panel.grid.major.x = element_blank(),
      panel.grid.minor = element_blank(),
      
      # 文字排版 (Typography)
      plot.title    = element_text(face = "bold", size = 16, hjust = 0, margin = margin(b = 5)),
      plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 15)),
      plot.caption  = element_text(size = 9, hjust = 0, color = "#555555", margin = margin(t = 10)),
      axis.title    = element_blank(),  # 隐藏轴标题 (Hide axis titles)
      axis.text     = element_text(color = "#333333", size = 10),
      
      # 图例 (Legend)
      legend.position = "top",
      legend.justification = "left",
      legend.background = element_blank(),
      legend.key = element_blank()
    )
}

# 绘制红色标签的黑科技函数
# Magic function to draw the red tag
add_economist_tag <- function(plot) {
  # 创建红色矩形 (Create red rectangle)
  tag <- rectGrob(
    x = unit(0.02, "npc"), y = unit(1, "npc") - unit(2, "mm"),
    width = unit(15, "mm"), height = unit(8, "mm"),
    hjust = 0, vjust = 1,
    gp = gpar(fill = econ_red, col = NA)
  )
  
  # 将矩形添加到图表顶部 (Add to top of plot)
  grid.arrange(plot, top = textGrob("", gp = gpar(fontsize = 1))) # 增加顶部边距 (Add margin)
  grid.draw(tag)
}
```

## 2. Line Chart: Inflation Rate (折线图)

Let's visualize inflation data.

```r
# 1. 准备数据
# Prepare data
data(economics)
df_line <- economics %>% filter(date > "2000-01-01")

# 2. 基础绘图
# Basic Plot
p1 <- ggplot(df_line, aes(x = date, y = uempmed)) +
  geom_line(color = econ_blue, size = 1.2) +
  labs(
    title = "Unemployment Duration",
    subtitle = "Median duration of unemployment (weeks)",
    caption = "Source: US Bureau of Labor Statistics"
  ) +
  scale_y_continuous(position = "right") + # Y轴放在右侧模仿 Economist (Y-axis on right)
  theme_economist_manual()

# 3. 添加红标并输出
# Add red tag and output
# 注意：在 RStudio 或 Quarto 中，grid.draw 可能不会直接显示在新行
# Note: grid.draw works best when saving or rendering
p1
grid.draw(rectGrob(x = 0.05, y = 0.96, width = 0.08, height = 0.04, gp = gpar(fill = econ_red, col = NA)))
```

## 3. Bar Chart: Categorical Data (柱状图)

```r
# 1. 准备数据
# Prepare data
df_bar <- mtcars %>%
  tibble::rownames_to_column("model") %>%
  head(8)

# 2. 绘图
# Plot
p2 <- ggplot(df_bar, aes(x = reorder(model, mpg), y = mpg)) +
  geom_col(fill = econ_blue, width = 0.7) +
  geom_text(aes(label = mpg), hjust = 1.5, color = "white", fontface = "bold") +
  coord_flip() +
  labs(
    title = "Fuel Efficiency",
    subtitle = "Miles per Gallon (Top 8 Models)",
    caption = "Source: Motor Trend Car Road Tests"
  ) +
  theme_economist_manual() +
  theme(panel.grid.major.y = element_blank()) # 移除柱状图的横线 (Remove horizontal lines for bars)

# 3. 显示
p2
grid.draw(rectGrob(x = 0.05, y = 0.96, width = 0.08, height = 0.04, gp = gpar(fill = econ_red, col = NA)))
```

## 4. Scatter Plot (散点图)

```r
p3 <- ggplot(iris, aes(x = Sepal.Length, y = Petal.Length)) +
  geom_point(color = econ_blue, alpha = 0.6, size = 3) +
  geom_smooth(method = "lm", color = econ_red, size = 1, se = FALSE) +
  labs(
    title = "Iris Dimensions",
    subtitle = "Sepal Length vs. Petal Length",
    caption = "Source: Fisher's Iris Data"
  ) +
  theme_economist_manual()

p3
grid.draw(rectGrob(x = 0.05, y = 0.96, width = 0.08, height = 0.04, gp = gpar(fill = econ_red, col = NA)))
```

## Summary

By manually defining the theme colors and using `grid.draw` to place the red rectangle, we achieve a result that is pixel-perfect to *The Economist*. No shortcuts!
